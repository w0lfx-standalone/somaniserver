# v1.2 â€“ TrueNAS Setup and Pool Management  

## Objective  
With Proxmox and the core VMs in place, the next step was to configure **TrueNAS SCALE** as the storage backbone of the system.  
The goals of this stage were:  
- Create a redundant ZFS pool for data reliability  
- Organize storage into service-specific datasets  
- Configure NFS shares to integrate with the Ubuntu VM  
- Standardize permissions via UID/GID mapping  

## TrueNAS Installation  
- Installed TrueNAS SCALE into its dedicated VM (80GB boot disk, 1 vCPU, 5.5GB RAM)  
- Verified LAN connectivity through bridged networking  
- Applied latest system updates  

![TrueNAS Dashboard](https://github.com/w0lfx-standalone/somaniserver/blob/main/assets/truenas_dashboard.png)


## Pool Creation  
- Used the 2Ã—2TB HDDs (passed through from Proxmox) to create a **ZFS mirror pool** named `swimming_pool`  
- Verified resiliency: single disk failure still keeps data safe  
- Enabled basic pool health monitoring in TrueNAS  

![TrueNAS Pool Dashboard](https://github.com/w0lfx-standalone/somaniserver/blob/main/assets/truenas_pool.png)

## Dataset Structure  
### Created dedicated datasets for modular service isolation:  
- `immich/` â€“ Photo & video backups  
- `nextcloud/` â€“ File syncing and collaboration  
- `seafile/` â€“ Lightweight versioning + sync   
- `media/` â€“ Shared general storage  

![TrueNAS Dataset](https://github.com/w0lfx-standalone/somaniserver/blob/main/assets/truenas_datasets.png)

## Sharing & Permissions  
- Configured **NFS shares** for each dataset  
- Created `somaniserver` (UID 3000) and `somanigroup` (GID 3001) on both TrueNAS and Ubuntu for permission consistency  
- Applied POSIX ACLs so all datasets are owned by `3000:3001`  
- Mounted each dataset on Ubuntu and tested read/write  

![TrueNAS NFS](https://github.com/w0lfx-standalone/somaniserver/blob/main/assets/truenas_nfsconfig.png)

![Ubuntu Mount](https://github.com/w0lfx-standalone/somaniserver/blob/main/assets/ubuntu_ownership_and_mounts.png)
## Verification & Testing  
- Performed file creation and deletion tests from Ubuntu â†’ TrueNAS datasets  
- Confirmed UID/GID mapping worked correctly (`ls -l` showed `somaniserver:somanigroup`)  
- Tested NFS performance with sample transfers  

![Ubuntu Mount test](https://github.com/w0lfx-standalone/somaniserver/blob/main/assets/ubuntu_mounttest.png)

## ðŸ”„ Version Note  
This milestone establishes the **storage foundation** for somaniserver.  
- Redundancy is ensured through a ZFS mirror.  
- Datasets are modular and isolated per service.  
- NFS integration and UID/GID mapping allow seamless access from the Ubuntu VM.  

With storage now reliable and centralized, the project is ready to move forward to **v1.3: Setting up Immich**.  
